<!DOCTYPE html>
<html lang="zh-TW">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>REINVENT ME - THE TURNS</title>

  <style>
    @font-face {
      font-family: 'Unifont';
      src: url('fonts/unifont.otf') format('opentype');
    }

    body {
      margin: 0;
      font-family: 'Unifont', monospace;
      font-size: 20px;
      line-height: 1.6;
      color: #00ffcc;
      background: url('images/worldmap.jpg') no-repeat center center / cover;
      background-color: black;
      background-attachment: fixed;
      
    }
    
    /* ======= 地圖封面樣式 ======= */
    #cover-map {
      position: absolute;
      width: 100vw;
      height: 100vh;
      background: url('images/worldmap.jpg') no-repeat center center / cover;
      overflow: hidden;
    }

    .map-character {
      position: fixed;
      left: 50%;
      top: 50%;
      width: 55px;
      height: 55px;
      background: url('images/walking-man.gif') no-repeat center center / contain;
      cursor: pointer;
      transition: top 2s ease, left 2s ease;
      transform-origin: center center;
      z-index: 1;
      
    }
  

    .map-popup {
      display: none;
      position: absolute;
      left: 50%;
      top: 60%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.9);
      border: 2px solid #00ffcc;
      padding: 20px;
      text-align: center;
      color: #00ffcc;
      z-index: 10;
    }

    .map-popup button {
      margin-top: 15px;
      padding: 10px 20px;
      background-color: #00ffcc;
      border: none;
      color: black;
      cursor: pointer;
      font-family: 'Unifont', sans-serif;
    }

    .map-popup button:hover {
      background-color: black;
      color: #00ffcc;
      border: 2px solid #00ffcc;
      box-shadow: 
        inset 2px 2px 0 #00ffcc,
        0 0 5px #00ffcc,               /* 外圍微微發光 */
        0 0 10px rgba(0, 255, 204, 0.5); /* 遠一點的光暈 */
      
      transform: scale(1.02);
      transition: all 0.2s ease;
    }

    #taiwan-container {
      display: none;
      position: absolute;
      left: 90%;
      top: 50%;
      transform: translate(-50%, -50%) scale(0.5);
      opacity: 0;
      z-index: 5;
      text-align: center;
      transition: transform 1s ease-out, opacity 1s ease-out;
    }

    
    #taiwan-glow {
      position: absolute;
      left: 1206px;
      top: 362px;
      width: 15px;
      height: 15px;
      border-radius: 50%;
      background: radial-gradient(circle, rgba(255, 215, 0, 0.9), rgba(255, 165, 0, 0.2));
      animation: glowPulse 2s ease-in-out infinite;
      transform: translate(-50%, -50%);
      z-index: 10;
      pointer-events: none;
      display: none;
    }

    @keyframes glowPulse {
      0% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.6;
      }
      50% {
        transform: translate(-50%, -50%) scale(1.5);
        opacity: 1;
      }
      100% {
        transform: translate(-50%, -50%) scale(1);
        opacity: 0.6;
      }
    }

    .taiwan-info {
      font-size: 16px;
      color:#00ffcc;
      background-color: rgba(0, 0, 0, 0.8);
      padding: 10px 20px;
      border: 2px solid #00ffcc;
      display: inline-block;
      text-align: left;
      max-width: 300px;
      box-sizing: border-box;
      border-radius: 8px;
      box-shadow: 0 0 15px #00ffcc;
    }
    
    .taiwan-info .card-content {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 10px;
    }

    .taiwan-info img {
      width: 120px;
      height: auto;
      margin-left: 10px;
      display: block;
      
    }

    .vertical-text {
      writing-mode: vertical-rl;
      text-orientation: upright;
      font-size: 24px;
      font-weight: bold;
      line-height: 1.4;
      padding: 0 5px;
      text-align: center;
      color: gold;
      text-shadow: 0 0 10px gold, 0 0 10px #fff;
      
    }


    .info-row {
      display: flex;
      justify-content: space-between;
      margin: 4px 0;
    }

    .label {
      width: 65%;
      text-align: left;
    }

    .value {
      width: 35%;
      text-align: right;
    }

    


    /* ======= 主遊戲樣式 ======= */
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 40px 20px;
    }

    .section {
      display: none;
      flex-direction: column;
      align-items: center;
      margin-bottom: 60px;
    }

    .timeline {
      width: 100%;
      height: 100px;
      position: relative;
      margin-bottom: 30px;
      background-color: rgba(0, 0, 0, 0.6);
      border: 2px solid #00ffcc;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 20px;
    }

    .timeline-marker {
      font-size: 16px;
    }

    .story {
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border: 2px solid #00ffcc;
      width: 100%;
      margin-bottom: 20px;
      white-space: pre-wrap;
      z-index: 3;
    }

    .dialogue {
      display: none;
      background-color: #111;
      border: 2px solid #00ffcc;
      padding: 20px;
      text-align: center;
    }

    .choices button {
      margin: 10px;
      padding: 10px 20px;
      background-color: #00ffcc;
      border: none;
      color: black;
      font-family: 'Unifont', sans-serif;
      cursor: pointer;
    }

    .result {
      display: none;
      background-color: #3e3a39;           /* 復古棕灰底 */
      color: #eae6d5;                      /* 米白字，復古螢幕風格 */
      padding: 20px;
      border: 2px solid #c2aa71;           /* 暗金色邊框 */
      margin-top: 20px;
      font-family: 'Unifont', monospace;     /* 等寬像素感字體 */
      font-size: 18px;
      white-space: pre-wrap;

      /* 陰影效果：像素位移感 */
      box-shadow:
        0 0 0 1px #000 inset,             /* 黑框像素內邊 */
        2px 2px 0 #000,                   /* 像素陰影效果 */
        0 0 10px rgba(0, 0, 0, 0.5);      /* 輕柔模糊陰影 */

      background-image: repeating-linear-gradient(
        0deg, rgba(255,255,255,0.02), rgba(255,255,255,0.02) 1px,
        transparent 1px, transparent 4px
      );
    }

  </style>
</head>

<body>
  <!-- 地圖封面 -->
  <div class="map-character" onclick="showPopup()"></div>
  <div id="cover-map">
    
    
    <div id="taiwan-glow"></div>

  <div id="taiwan-container">
      
    <div class="taiwan-info">
      <div class="card-content">
        <div class="vertical-text">TAIWAN<br>SSR・</div>
        <img id="taiwan-map" src="images/tw-map.jpg" alt="台灣地圖">
      </div>
      <!-- 下方資料欄 -->
      <div class="info-row"><span class="label">HDI 排名</span><span class="value">No.19</span></div>
      <div class="info-row"><span class="label">人類發展指數</span><span class="value">0.926</span></div>
      <div class="info-row"><span class="label">平均壽命</span><span class="value">79.8 yrs</span></div>
      <div class="info-row"><span class="label">投胎稀有度</span><span class="value">0.2905%</span></div>
    </div>
    
  </div>

    <div class="map-popup" id="map-popup">
      <p>你在投胎時，幸運地抽到SSR卡片:台灣！<br>點擊「開始旅程」展開你重啟的人生。</p>
      <button onclick="startJourney()">開始旅程</button>
    </div>
  </div>

  <!-- 主流程容器 -->
  <div class="container">
   
    <!-- step1 -->
    <div class="section" id="step1">
      <div class="timeline">
        <div class="timeline-marker">🕒 2004｜升學 : 我想成為誰?</div>
        
      </div>
      <div class="story" id="story1"></div>
      <div class="dialogue" id="dialogue1">
        你是否要不顧家人與老師的建議，選擇就讀餐飲科？<br>
        <div class="choices">
          <button onclick="wrongChoice('step1')">是</button>
          <button onclick="nextStep('step1', 'step2')">否</button>
        </div>
      </div>
      <div class="result" id="result1"></div>
    </div>

    <!-- step2 -->
    <div class="section" id="step2">
      <div class="timeline">
        <div class="timeline-marker">🕒 2013｜改變的第一步 : 我想要的，我自己努力努力!</div>
        
      </div>
      <div class="story" id="story2"></div>
      <div class="dialogue" id="dialogue2">
        你是否願意承擔未知的後果與得失，前往澳洲打工賺取學費？<br>
        <div class="choices">
          <button onclick="nextStep('step2', 'step3')">是</button>
          <button onclick="wrongChoice('step2')">否</button>
        </div>
      </div>
      <div class="result" id="result2"></div>
    </div>

    <!-- step3 -->
    <div class="section" id="step3">
      <div class="timeline">
        <div class="timeline-marker">🕒 2018｜推開世界的門 : 好奇心是把雙面刃。</div>
        
      </div>
      <div class="story" id="story3"></div>
      <div class="dialogue" id="dialogue3">
        你是否願意離開現在的生活圈，放棄你的移民計畫，前往挑戰美國職場？<br>
        <div class="choices">
          <button onclick="nextStep('step3', 'step4')">是</button>
          <button onclick="wrongChoice('step3')">否</button>
        </div>
      </div>
      <div class="result" id="result3"></div>
    </div>

    <!-- step4 -->
    <div class="section" id="step4">
      <div class="timeline">
        <div class="timeline-marker">🕒 2020｜容忍它發生 : 宇宙裡唯一的永恆是"變化"。</div>
        
      </div>
      <div class="story" id="story4"></div>
      <div class="dialogue" id="dialogue4">
        考慮了一陣子以後，你是否要接受邀約前往倫敦？<br>
        <div class="choices">
          <button onclick="wrongChoice('step4')">是</button> 
          <button onclick="nextStep('step4', 'step5')">否</button> 
        </div>
      </div>
      <div class="result" id="result4"></div>
    </div>
    <!-- step5 -->
    <div class="section" id="step5">
      <div class="timeline">
        <div class="timeline-marker">🕒 2023｜被偷走的那幾年 : 日子與我都淹沒在世界的暫停裡。 </div>
        
      </div>
      <div class="story" id="story5"></div>
      <div class="dialogue" id="dialogue5">
        你是否要再次離開熟悉的舒適圈，前往加拿大？<br>
        <div class="choices">
          <button onclick="nextStep('step5', 'step6')">是</button>
          <button onclick="wrongChoice('step5')">否</button>
        </div>
      </div>
      <div class="result" id="result5"></div>
    </div>

    <!-- step6 -->
    <div class="section" id="step6">
      <div class="timeline">
        <div class="timeline-marker">🕒 2024｜苦難 : 凡殺不死我的，必使我強大。</div>
        
      </div>
      <div class="story" id="story6"></div>
      <div class="dialogue" id="dialogue6">
        你是否要與主廚妥協，以換取繼續在星級餐廳工作？<br>
        <div class="choices">
          <button onclick="wrongChoice('step6')">是</button>
          <button onclick="nextStep('step6', 'step7')">否</button>
        </div>
      </div>
      <div class="result" id="result6"></div>
    </div>

    <!-- step7 -->
    <div class="section" id="step7">
      <div class="timeline">
        <div class="timeline-marker">🕒 2025｜重啟 :我會成為我想要的樣子 。</div>
        
      </div>
      <div class="story" id="story7"></div>
      <div class="dialogue" id="dialogue7">
        你是否願意暫時放下你的不安，朝成為軟體工程師的方向努力努力？<br>
        <div class="choices">
          <button onclick="endGame()">是</button>
          <button onclick="wrongChoice('step7')">否</button>
        </div>
      </div>
      <div class="result" id="result7"></div>
    </div>

  <script>
    const stories = [
      `你從小就擅長讀書考試，雖然不太懂上學的意義，但還是乖乖地扮演好學生。
你十五歲時，即將升上高中，面臨了人生第一個岔路口，
因為你的成績還不錯，所以父母與學校的老師都希望你選擇普通高中。

但你總是對廚房的事物特別著迷，當時你心中有個想法是:
"我能不能選讀餐飲科...?"`,

      `你高中時成績尚可，但對於人生的方向並沒有太多的機會探尋，
你因為喜歡生物課，也熱愛做實驗，於是考大學時你申請了北醫醫技系，並成功的錄取。
你在醫院實習時，發現自己雖然不討厭成為醫檢師，但也沒有太多的熱情。

大學畢業後你迷茫了一陣子，但後來想通了，
你決定要試著追尋過往未竟的願望: 成為專業廚師。
你得不到家人的支持，於是你希望前往澳洲打工，迅速賺取廚藝學校的學費。
但這個計畫充滿了未知，也可能會非常辛苦，你猶豫了一陣子...`,

      `你抵達澳洲後，在農場日出而作日落而息，雖然工作辛苦，但日子過得充實寧靜。
你很快地存到了學費，花了點時間考英文並順利地申請進廚藝學校。
在那裡你認識了來自世界各地的同學，
也藉由打工與課堂實作學習到關於商業廚房的各種知識及烹飪技巧。

後來你在實習期間，偶然得知了美國的工作機會，
你非常心動，但若前往美國將會打亂你移民澳洲的計畫...`,

      `你在紐約的廚房開始工作，雖然壓力與節奏都與澳洲不同，
但你的學習能力很好，工作時有條不紊，你適應得不錯並且受到主廚的肯定。

某天，主廚因為你的工作合約即將到期，於是找你面談，
他邀請你前往倫敦的分店任職，
你當時很喜歡紐約的環境，也結交了許多朋友，你並不是很想離開，
但另一方面，你也很想探索未知的一隅...`,


      `不久後新冠疫情在全球爆發，
爆發初期，台灣因為相對安全，家人希望你先回家避難，你評估之後決定先回台灣。
後來你到台北的餐廳工作，
發現自己對於台灣的職場文化不太適應，但你決定先忍耐或想辦法溝通與克服。
最終你還是失去了生活與工作的平衡，
整個人變得很不快樂，甚至開始討厭下廚且懷疑人生。

你痛定思痛，思考再三，最後你決定離職並且離開台北。
回到台中，你沉澱了一陣子，始終覺得有種漂流未竟之感，
於是你鎖定了加拿大打工的機會，但由於你已不如過去身強體壯，你很猶豫...`,

      `你懷抱著重拾新生活的心前往多倫多，並得到機會在一間米其林餐廳工作。
起初你兢兢業業地工作，以為一切都開始好轉了起來，
但你發現你的主管會在工作時言語騷擾你，或是將你的物品藏起來霸凌你，
你忍耐了許久以後，終於在某一天內心的小火山爆發了!
你將事情報告主廚，但主廚顯然偏袒你的主管，於是你的天秤開始拉扯...`,

      `你回到台灣，檢討自己，思考了許多關於人與人之間的，關於職涯的，
關於人生的各種抉擇。
你對自己十分失望，於是求助朋友開導你，最後你們討論出一個結論:
"世界之大，只有你不想做的事，沒有你不能做的事。"

你決定轉換跑道，重啟人生，目標是進入科技產業。
雖然你毫無基礎，經濟也不寬裕，
但你想辦法報名了職訓局補助的 AIoT 與 Python 相關的課程，
你在課堂中由老師引領入門，
學到了Arduino、前端設計、資料庫、app設計、python、以及AI辨識等等的知識，
雖然都很粗淺，但你仍然努力地與同學協作完成了一個簡單的專題。
在學習期間，你發現自己的個性其實很適合邏輯思考，也很喜歡安安靜靜的完成任務，
你覺得你適合、也願意繼續探索科技領域，
但你十分擔心你已年華老去，前方可能障礙重重...`
];

    const wrongEndings = [
      '你選擇了進入餐飲科，並且兢兢業業的學習，畢業後你在餐飲業工作了十年，最後開了自己的小店，生意興隆，你雖忙碌但很快樂。The End。',
      '你沒有去澳洲，而是選擇留在台灣準備國考，考到醫檢師執照後，你開始在醫院裡工作，一晃眼就是十年，你發現安穩的日子其實也不錯。The End。',
      '你決定留在澳洲完成移民計畫，經過了十年的努力，你終於拿到了澳洲公民的身分，雖然完成了一個遠大的目標，但你始終覺得你是個異鄉人。The End。',
      '你接受主廚的邀請前往倫敦工作，但做沒多久新冠疫情就爆發，你因為封城關在家裡太無聊，開始經營YT拍攝自己的耍廢生活，卻意外獲得了許多粉絲，於是你轉職成為Youtuber，目前粉絲穩定成長中。The End。',
      '你沒有去加拿大，就在你感覺人生卡住的時候，朋友丟給你一組他不想上的線上占星課程，經過了幾年，你靠自己研究出一番成果，成為一個專業的占星師，不僅為自己解惑，也為他人解惑。The End。',
      '你決定忍辱負重繼續熬下去，終於在熬了十年以後，你自己開了一間餐廳，並且成功的摘星，成為米其林星級主廚。The End。。',
      '你決定保守的生活，報名了高普考，由於你擅長讀書考試，一兩年之後就順利地考上，成為公務員之後，工作難免乏味但卻穩定，你已知足。The End。'
    ];

    function typeText(text, el, cb) {
      let i = 0;
      const speed = 30;
      let skip = false;
      let typing = true;

      const interval = setInterval(() => {
        if (skip) {
          el.textContent = text;
          clearInterval(interval);
          document.removeEventListener("click", handleClick);
          typing = false;
          if (cb) cb();
          return;
        }

        el.textContent += text.charAt(i);
        i++;
        if (i === text.length) {
          clearInterval(interval);
          document.removeEventListener("click", handleClick);
          typing = false;
          if (cb) cb();
        }
      }, speed);

      // ⚠️ 必須在 setInterval 後再啟用 click listener，避免立即觸發
      const handleClick = () => {
        if (typing) skip = true;
      };
      setTimeout(() => {
        document.addEventListener("click", handleClick);
      }, 100); // 避免初始化時立即觸發
    }

      //小人位置+動畫
      const characterPositions = {
        step1: { left: 1190, top: 300, range: 20 },    // 台灣
        step2: { left: 1190, top: 300, range: 20 },   
        step3: { left: 1300, top: 580, range: 40 },    // 澳洲
        step4: { left: 350, top: 230, range: 35 },     // 美國
        step5: { left: 1200, top: 300, range: 20 },    
        step6: { left: 320, top: 180, range: 35 },     // 加拿大
        step7: { left: 1200, top: 300, range: 20 }      
      };

      let walkInterval = null;

    function moveCharacterToStep(stepId) {
      const character = document.querySelector('.map-character');
      const position = characterPositions[stepId];
      if (!position) return;

      if (walkInterval) clearInterval(walkInterval);

      const centerX = position.left;
      const centerY = position.top;
      const walkRange = position.range || 25;
      let direction = 1;
      let lastDirection = 1;
      let currentX = centerX;

      character.style.left = `${currentX}px`;
      character.style.top = `${centerY}px`;
      character.style.backgroundImage = "url('images/walking-man.gif')";
      
      walkInterval = setInterval(() => {
        currentX += direction;
        character.style.left = `${currentX}px`;

        let hitLeft = currentX <= centerX - walkRange;
        let hitRight = currentX >= centerX + walkRange;

        if (hitLeft || hitRight) {
          direction *= -1; // 先改方向
          if (direction !== lastDirection) {
            character.style.backgroundImage =
              direction === -1
                ? "url('images/walking-man-left.gif')"
                : "url('images/walking-man.gif')";
            lastDirection = direction;
          }
        }
      }, 50);
    }


    function showStep(id, index) {
      const section = document.getElementById(id);
      section.style.display = 'flex';
      const storyEl = document.getElementById('story' + (index + 1));
      typeText(stories[index], storyEl, () => {
        document.getElementById('dialogue' + (index + 1)).style.display = 'block';
      });
      moveCharacterToStep(id); // 讓小人隨故事移動
    }

    function nextStep(current, next) {
      document.getElementById(current).style.display = 'none';
      showStep(next, parseInt(next.replace('step', '')) - 1);
    }

    function wrongChoice(stepId) {
      const idx = parseInt(stepId.replace('step', '')) - 1;
      const result = document.getElementById('result' + (idx + 1));
      result.innerHTML = wrongEndings[idx] + '<br><br><button onclick="retryStep(\'' + stepId + '\')">再選一次</button>';
      result.style.display = 'block';
      document.getElementById('dialogue' + (idx + 1)).style.display = 'none';
    }

    function retryStep(stepId) {
      const idx = parseInt(stepId.replace('step', '')) - 1;
      const section = document.getElementById(stepId);
      section.style.display = 'flex';
      const storyEl = document.getElementById('story' + (idx + 1));
      storyEl.textContent = '';
      document.getElementById('dialogue' + (idx + 1)).style.display = 'none';
      document.getElementById('result' + (idx + 1)).style.display = 'none';
      showStep(stepId, idx);
    }

    function endGame() {
      window.location.href = "ending.html";
    }

    function showPopup() {
      document.getElementById('map-popup').style.display = 'block';

      const taiwanContainer = document.getElementById('taiwan-container');
      taiwanContainer.style.display = 'block';
      document.getElementById('taiwan-glow').style.display = 'block';

      setTimeout(() => {
        taiwanContainer.style.opacity = '1';
        taiwanContainer.style.transform = 'translate(-50%, -50%) scale(1)';
      }, 50);

      // 停止小人飄動
      clearInterval(window.characterInterval);

      // 移動小人到指定位置
      const character = document.querySelector('.map-character');
      character.style.left = '1200px';
      character.style.top = '300px';

      character.style.backgroundImage = "url('images/walking-man-stopped.png')";
      
      
    }  
      
    function startJourney() {
      document.getElementById('cover-map').style.display = 'none';
      showStep('step1', 0);
    }
    
    window.onload = () => {
      const character = document.querySelector('.map-character');

    function moveCharacterRandomly() {
      const map = document.getElementById('cover-map');
      const mapWidth = map.offsetWidth;
      const mapHeight = map.offsetHeight;

      // 計算範圍內隨機位置（避免超出畫面）
      const x = Math.random() * (mapWidth - 60); // 預留寬度
      const y = Math.random() * (mapHeight - 60); // 預留高度

      character.style.left = `${x}px`;
      character.style.top = `${y}px`;
    }
    // 每 3 秒飄動一次
    window.characterInterval = setInterval(moveCharacterRandomly, 3000);

    // 第一次載入先動一次
    moveCharacterRandomly();
    };
  </script>
</body>

</html>
